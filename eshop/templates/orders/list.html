{% extends "base.html" %}
{% block title %}Мои заказы - E-Shop{% endblock %}
{% block content %}
<div class="row">
  <div class="col">
    <h1>Мои заказы</h1>

    {% if orders %}
    <div class="table-responsive">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>№ заказа</th>
            <th>Дата</th>
            <th>Товары</th>
            <th>Сумма</th>
            <th>Статус</th>
            <th>Оплата</th>
            <th>Действия</th>
          </tr>
        </thead>
        <tbody>
          {% for order in orders %}
          <tr>
            <td>{{ order.id }}</td>
            <td>{{ order.created|date:"d.m.Y H:i" }}</td>
            <td>
              {% for item in order.items.all %} {{ item.product.name }} ({{
              item.quantity }})<br />
              {% endfor %}
            </td>
            <td>{{ order.total_cost }} ₽</td>
            <td>
              <span
                class="badge {% if order.status == 'delivered' %}bg-success {% elif order.status == 'cancelled' %}bg-danger {% elif order.status == 'processing' %}bg-info {% else %}bg-warning{% endif %}"
              >
                {{ order.get_status_display }}
              </span>
            </td>
            <td>
              {% if order.paid %}
              <span class="badge bg-success"
                ><i class="bi bi-check-circle"></i> Оплачен</span
              >
              {% else %}
              <span class="badge bg-danger"
                ><i class="bi bi-x-circle"></i> Не оплачен</span
              >
              {% endif %}
            </td>
            <td>
              <a
                href="{% url 'orders:order_detail' order.id %}"
                class="btn btn-sm btn-outline-primary"
              >
                Подробнее
              </a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="alert alert-info" role="alert">
      У вас пока нет заказов.
      <a href="{% url 'shop:product_list' %}">Перейти к покупкам</a>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
